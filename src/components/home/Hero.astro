---
import { t } from '@/i18n';
import type { Lang } from '@/i18n/config';

interface Props {
  lang: Lang;
  chips: Array<{ [key: string]: string }>;
  location: string;
  email: string;
  linkedin: string;
}

const { lang, chips, location, email, linkedin } = Astro.props;

// Helper to get localized string
const getStr = (obj: any) => (typeof obj === 'string' ? obj : obj[lang]);
---

<section class="hero-section section min-h-[62vh] flex items-start pt-10 md:pt-14 relative overflow-hidden">
  <!-- Subtle hero framing -->
  <div class="absolute inset-0 bg-gradient-to-b from-transparent to-background-alt/20 pointer-events-none"></div>
  <div class="absolute left-0 top-20 bottom-20 w-px bg-border/60 pointer-events-none"></div>
  <div class="absolute left-0 top-0 h-full w-[45%] bg-gradient-to-br from-background-alt/70 to-transparent pointer-events-none"></div>

  <div class="container relative z-10">
    <div class="max-w-4xl">
      <!-- Chips -->
      <div class="flex flex-wrap gap-2 mb-4 stagger-children">
        {chips.map((chip, index) => (
          <span 
            class="inline-flex items-center px-3 py-1 text-xs font-semibold tracking-wide rounded-full bg-background-alt text-foreground border border-border/70 shadow-sm animate-fade-in-up fill-mode-forwards"
            style={`animation-delay: ${index * 100}ms;`}
          >
            {getStr(chip)}
          </span>
        ))}
      </div>

      <!-- Headline -->
      <div class="overflow-hidden mb-4 pb-2">
        <h1 class="text-4xl md:text-5xl lg:text-7xl font-bold text-foreground animate-reveal-text font-display leading-tight">
          {t(lang, 'hero.headline')}
        </h1>
      </div>

      <!-- Subheadline -->
      <div class="overflow-hidden mb-5 pb-1">
        <p class="text-xl md:text-2xl text-foreground opacity-80 max-w-2xl animate-reveal-text" style="animation-delay: 200ms;">
          {t(lang, 'hero.subheadline')}
        </p>
      </div>

      <!-- Meta Line -->
      <div class="flex flex-wrap items-center gap-4 text-sm text-muted mb-6 animate-fade-in-up fill-mode-forwards" style="animation-delay: 500ms;">
        <span>{location}</span>
        <span class="text-border">|</span>
        <a href={`mailto:${email}`} class="hover:text-accent transition-colors">
          {email}
        </a>
        <span class="text-border">|</span>
        <a href={linkedin} target="_blank" rel="noopener noreferrer" class="hover:text-accent transition-colors">
          LinkedIn
        </a>
      </div>

      <!-- CTAs -->
      <div class="flex flex-wrap gap-4 animate-fade-in-up fill-mode-forwards" style="animation-delay: 600ms;">
        <a
          href="#systems"
          class="inline-flex items-center justify-center px-7 py-3 text-base font-semibold rounded-lg bg-primary text-white hover:bg-primary-light transition-colors shadow-lg hover:shadow-xl hover:-translate-y-0.5 transform duration-200"
        >
          {t(lang, 'hero.cta.viewSystems')}
        </a>
        <a
          href={`/${lang}/resume`}
          class="inline-flex items-center justify-center px-6 py-3 text-base font-medium rounded-lg border border-border text-foreground bg-background-alt/60 hover:bg-background-alt transition-colors hover:border-accent"
        >
          {t(lang, 'hero.cta.recruiterMode')}
        </a>
      </div>
    </div>
  </div>
</section>

<style>
  .fill-mode-forwards {
    animation-fill-mode: forwards;
  }
  
  @keyframes revealText {
    from {
      transform: translateY(100%);
    }
    to {
      transform: translateY(0);
    }
  }
  
  .animate-reveal-text {
    transform: translateY(100%);
    animation: revealText 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }

  @media (prefers-reduced-motion: reduce) {
    .animate-reveal-text {
      transform: none;
      animation: none;
    }
  }
</style>

<script>
  // Magnetic button effect for CTAs
  function initMagneticButtons() {
    // Check if user prefers reduced motion
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReducedMotion) return;

    const buttons = document.querySelectorAll('.hero-section a[href="#systems"], .hero-section a[href*="/resume"]');

    buttons.forEach(button => {
      const el = button as HTMLElement;

      el.addEventListener('mouseenter', () => {
        el.style.transition = 'transform 0.1s ease-out';
      });

      el.addEventListener('mousemove', (e: MouseEvent) => {
        const rect = el.getBoundingClientRect();
        const x = e.clientX - rect.left - rect.width / 2;
        const y = e.clientY - rect.top - rect.height / 2;

        el.style.transform = `translate(${x * 0.15}px, ${y * 0.15}px)`;
      });

      el.addEventListener('mouseleave', () => {
        el.style.transition = 'transform 0.3s ease-out';
        el.style.transform = 'translate(0, 0)';
      });
    });
  }

  // Initialize on page load
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initMagneticButtons);
  } else {
    initMagneticButtons();
  }
</script>
