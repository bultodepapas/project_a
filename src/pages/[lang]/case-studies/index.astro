---
/**
 * Case Studies Index
 * Filterable list of all case studies
 */

import Page from '@/layouts/Page.astro';
import { supportedLangs, type Lang, isValidLang } from '@/i18n/config';
import { t } from '@/i18n';

// Generate static paths for each language
export function getStaticPaths() {
  return supportedLangs.map((lang) => ({
    params: { lang },
  }));
}

const { lang } = Astro.params;

// Validate language
if (!isValidLang(lang)) {
  return Astro.redirect('/en/case-studies');
}

const typedLang = lang as Lang;

// Case studies data (will be moved to content collections in Sprint 1)
const cases = [
  {
    slug: 'audience-framework',
    title: typedLang === 'es' ? 'Framework de Inteligencia de Audiencias' : 'Audience Intelligence Framework',
    description: typedLang === 'es'
      ? 'Metodologia multi-pais para medir cambio conductual y conciencia politica'
      : 'Multi-country methodology for behavioral change and policy awareness measurement',
    theme: 'audience',
    regions: ['LATAM', 'US/Canada', 'Europe'],
    featured: true,
  },
  {
    slug: 'benchmark-system',
    title: typedLang === 'es' ? 'Sistema de Benchmark de Desempeno' : 'Performance Benchmark System',
    description: typedLang === 'es'
      ? 'Metricas estandarizadas para comparar eficiencia de campanas entre regiones'
      : 'Standardized metrics to compare campaign efficiency across regions',
    theme: 'benchmark',
    regions: ['LATAM', 'US/Canada', 'Europe'],
    featured: true,
  },
  {
    slug: 'narrative-tracking',
    title: typedLang === 'es' ? 'Sistema de Seguimiento Narrativo' : 'Narrative Tracking System',
    description: typedLang === 'es'
      ? 'Monitoreo de tendencias y sentimiento en discurso ambiental'
      : 'Monitoring trends and sentiment in environmental discourse',
    theme: 'narrative',
    regions: ['Global'],
    featured: true,
  },
];

const pageTitle = t(typedLang, 'cases.index.title');
const pageDescription = t(typedLang, 'cases.index.subtitle');
---

<Page
  title={pageTitle}
  description={pageDescription}
  lang={typedLang}
>
  <div class="section">
    <div class="container">
      <!-- Header -->
      <header class="mb-12">
        <h1 class="text-3xl md:text-4xl font-bold text-foreground mb-4">
          {t(typedLang, 'cases.index.title')}
        </h1>
        <p class="text-lg text-muted max-w-2xl">
          {t(typedLang, 'cases.index.subtitle')}
        </p>
      </header>

      <!-- Filters (placeholder - will be enhanced in Sprint 3) -->
      <div class="flex flex-wrap gap-2 mb-8">
        <button class="px-4 py-2 text-sm font-medium rounded-full bg-primary text-white">
          {t(typedLang, 'cases.index.filters.all')}
        </button>
        <button class="px-4 py-2 text-sm font-medium rounded-full border border-border text-muted hover:border-accent hover:text-accent transition-colors">
          Audience
        </button>
        <button class="px-4 py-2 text-sm font-medium rounded-full border border-border text-muted hover:border-accent hover:text-accent transition-colors">
          Benchmark
        </button>
        <button class="px-4 py-2 text-sm font-medium rounded-full border border-border text-muted hover:border-accent hover:text-accent transition-colors">
          Narrative
        </button>
      </div>

      <!-- Case Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {cases.map((caseItem) => (
          <a
            href={`/${typedLang}/case-studies/${caseItem.slug}`}
            class="group p-6 rounded-xl bg-surface border border-border hover:border-accent hover:shadow-lg transition-all"
          >
            {caseItem.featured && (
              <span class="inline-flex items-center px-2 py-1 text-xs font-medium rounded bg-accent/10 text-accent mb-3">
                Featured
              </span>
            )}
            <span class="text-xs font-semibold uppercase tracking-wider text-accent">
              {caseItem.theme}
            </span>
            <h2 class="text-xl font-semibold text-foreground mt-2 group-hover:text-accent transition-colors">
              {caseItem.title}
            </h2>
            <p class="text-sm text-muted mt-2">
              {caseItem.description}
            </p>
            <div class="flex flex-wrap gap-2 mt-4">
              {caseItem.regions.map((region) => (
                <span class="text-xs text-muted px-2 py-1 rounded bg-background-alt">
                  {region}
                </span>
              ))}
            </div>
          </a>
        ))}
      </div>
    </div>
  </div>
</Page>